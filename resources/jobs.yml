resources:
  jobs:
    cdc_medallion_job:
      name: cdc-medallion-${bundle.target}

      tasks:
        - task_key: bronze
          spark_python_task:
            python_file: ${workspace.file_path}/src/main.py
            parameters: ["bronze"]
          job_cluster_key: job_cluster

        - task_key: silver
          depends_on: [{ task_key: bronze }]
          spark_python_task:
            python_file: ${workspace.file_path}/src/main.py
            parameters: ["silver"]
          job_cluster_key: job_cluster

        - task_key: quality
          depends_on: [{ task_key: silver }]
          spark_python_task:
            python_file: ${workspace.file_path}/src/main.py
            parameters: ["quality"]
          job_cluster_key: job_cluster

        - task_key: gold
          depends_on: [{ task_key: quality }]
          spark_python_task:
            python_file: ${workspace.file_path}/src/main.py
            parameters: ["gold"]
          job_cluster_key: job_cluster

      job_clusters:
        - job_cluster_key: job_cluster
          new_cluster:
            spark_version: "14.3.x-photon-scala2.12"
            node_type_id: "Standard_DS3_v2"
            autoscale:
              min_workers: 2
              max_workers: 8
